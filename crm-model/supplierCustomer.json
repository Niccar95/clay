{
  "name": "supplierCustomer",
  "localized_name": "Kund",
  "description": "restaurang, cafe, hotell, kontor, daglivaruhandel, gym",
  "alias": ["mottagare", "beställare", "slutkund", "köpare"],
  "mixin": ["default_actions", "linked_fields"],
  "defaultSort": "name",
  "defaultSimilaritySortField": "name",
  "calculatedFields": {},
  "children": {
    "supplierCustomerContacts": {
      "localized_name": "Kontakter",
      "tab": "Detaljer",
      "type": "array",
      "name": "supplierCustomerContacts",
      "linkedActions": {
        "removeContact": {
          "icon": "trash"
        },
        "writeContact": {
          "icon": "edit"
        }
      },
      "fields": {
        "id": {
          "type": "string",
          "primary": true,
          "description": "primary key",
          "localized_name": "Identitet"
        },
        "name": {
          "tab": "Detaljer",
          "type": "string",
          "localized_name": "Kundreferens",
          "required": true,
          "max_length": 50,
          "is_available_in_reference": true
        },
        "email": {
          "tab": "Detaljer",
          "type": "email",
          "localized_name": "E-post",
          "required": false,
          "max_length": 255,
          "is_available_in_reference": true
        },
        "phone": {
          "tab": "Detaljer",
          "type": "string",
          "localized_name": "Telefon",
          "required": false,
          "max_length": 255,
          "is_available_in_reference": true
        }
      }
    }
  },
  "fields": {
    "id": {
      "type": "string",
      "primary": true,
      "description": "primary key",
      "localized_name": "Identitet",
      "is_available_in_reference": true
    },
    "orderFullfillmentCenter": {
      "tab": "Detaljer",
      "type": "relation",
      "relation": "ofcInCrm",
      "original_relation": "orderFullfillmentCenter",
      "localized_name": "Leveranslager",
      "is_available_in_reference": true,
      "required_in_ui": true
    },
    "customerNumber": {
      "tab": "Detaljer",
      "namespace": "Detaljer",
      "type": "string",
      "searchable": true,
      "localized_name": "Kundnummer",
      "is_available_in_reference": true,
      "is_available_in_minimum_reference": true,
      "index_name": "unique_customerNumber_for_org",
      "unique_with": ["owningSupplierOrganizationId"],
      "unique_when": {
        "active": true,
        "customerNumber": { "and": [{ "ne": "<NULL>" }, { "ne": "" }] }
      }
    },
    "currency": {
      "tab": "Detaljer",
      "type": "currency",
      "localized_name": "Valuta",
      "max_length": 255,
      "fortnox_equivalent": "Currency",
      "required_in_ui": true,
      "default": "'SEK'",
      "is_available_in_reference": true
    },
    "name": {
      "tab": "Detaljer",
      "searchable": true,
      "type": "string",
      "localized_name": "Företagsnamn på faktura",
      "not_null": true,
      "max_length": 255,
      "required_in_ui": true,
      "is_available_in_reference": true,
      "is_available_in_minimum_reference": true
    },
    "organisationNumber": {
      "tab": "Detaljer",
      "searchable": true,
      "type": "string",
      "localized_name": "Organisationsnummer",
      "max_length": 255,
      "display_if": "entity.deliveryCountry === 'SE'",
      "is_available_in_reference": true
    },
    "VATNumber": {
      "tab": "Detaljer",
      "type": "string",
      "localized_name": "Momsnummer",
      "max_length": 255,
      "display_if": "entity.deliveryCountry === 'SE'",
      "is_available_in_reference": true
    },
    "deliveryCountry": {
      "tab": "Detaljer",
      "include": "restricted_values/country_codes",
      "localized_name": "Land",
      "default": "'SE'"
    },
    "chain": {
      "tab": "Detaljer",
      "type": "pipeString",
      "localized_name": "Kedja",
      "is_available_in_reference": true,
      "is_available_in_minimum_reference": true
    },
    "customerType": {
      "tab": "Detaljer",
      "include": "restricted_values/customer_types",
      "description": "kundtyp",
      "localized_name": "Kundtyp",
      "is_available_in_reference": true,
      "is_available_in_reference_ui": false
    },
    "yourReference": {
      "tab": "Detaljer",
      "type": "string",
      "localized_name": "Kundreferens",
      "max_length": 50
    },
    "email": {
      "tab": "Detaljer",
      "type": "email",
      "localized_name": "Kundens e-post (används för orderbekräftelse)",
      "max_length": 255,
      "is_available_in_reference": true
    },
    "invoiceDeliveryType": {
      "tab": "Fakturering",
      "type": "enum",
      "values": [
        {
          "key": "PRINT",
          "label": "Utskrift"
        },
        {
          "key": "EMAIL",
          "label": "E-post"
        },
        {
          "key": "ELECTRONICINVOICE",
          "label": "E-faktura"
        }
      ],
      "default": "'EMAIL'",
      "description": "derived from fortnox",
      "localized_name": "Fakturaleveranssätt"
    },
    "emailInvoice": {
      "tab": "Fakturering",
      "type": "email",
      "localized_name": "E-post för faktura",
      "max_length": 255,
      "display_if": "entity.invoiceDeliveryType === 'EMAIL'"
    },
    "phone": {
      "tab": "Detaljer",
      "type": "string",
      "localized_name": "Telefon"
    },
    "active": {
      "tab": "Detaljer",
      "type": "boolean",
      "localized_name": "Aktiverad",
      "is_available_in_reference": true,
      "max_length": 255,
      "default": true
    },
    "GLN": {
      "tab": "Kopplingsfält",
      "type": "GLN",
      "max_length": 255,
      "description": "NAD+BY i edifact",
      "localized_name": "GLN-nummer för köparen"
    },
    "GLNBY": {
      "tab": "Kopplingsfält",
      "type": "GLN",
      "max_length": 255,
      "description": "NAD+BY i edifact",
      "localized_name": "GLN-nummer för köparen"
    },
    "GLNIV": {
      "tab": "Kopplingsfält",
      "type": "GLN",
      "max_length": 255,
      "description": "NAD+IV i edifact",
      "localized_name": "GLN-nummer för fakturering"
    },
    "GLNCN": {
      "tab": "Kopplingsfält",
      "type": "GLN",
      "max_length": 255,
      "description": "NAD+CN i edifact",
      "localized_name": "GLN-nummer för leveranspartner"
    },
    "GLNDP": {
      "tab": "Kopplingsfält",
      "type": "GLN",
      "max_length": 255,
      "description": "NAD+DP i edifact",
      "localized_name": "GLN-nummer för leveransmottagare"
    },
    "GLNSU": {
      "tab": "Kopplingsfält",
      "type": "GLN",
      "max_length": 255,
      "description": "NAD+SU i edifact",
      "localized_name": "GLN-nummer för leverantörslager"
    },
    "invoiceAddress": {
      "tab": "Fakturering",
      "type": "string",
      "localized_name": "Adress",
      "max_length": 255
    },
    "invoiceAddress2": {
      "tab": "Fakturering",
      "type": "string",
      "localized_name": "Adress 2",
      "max_length": 255
    },
    "invoiceZipCode": {
      "tab": "Fakturering",
      "type": "string",
      "localized_name": "Postnummer",
      "max_length": 10
    },
    "invoiceCity": {
      "tab": "Fakturering",
      "type": "string",
      "localized_name": "Stad",
      "max_length": 255
    },
    "approvedCustomer": {
      "tab": "Fakturering",
      "type": "boolean",
      "description": "State to see if this customer is legit or not",
      "localized_name": "Godkänd kund"
    },
    "blocked": {
      "tab": "Fakturering",
      "type": "boolean",
      "description": "",
      "localized_name": "Kund har köpstopp"
    },
    "blockedReason": {
      "tab": "Fakturering",
      "type": "string",
      "description": "",
      "localized_name": "Anledning till köpstopp",
      "max_length": 255
    },
    "requiresGroupInvoice": {
      "tab": "Fakturering",
      "type": "boolean",
      "description": "True if this customer should recieve grouped invoices",
      "localized_name": "Samlingsfaktura",
      "default": true,
      "explanation": "Kunden får en samlingsfaktura för alla sina inköp under en period, om nej kommer order till kunden att faktureras automatiskt vid leverans",
      "is_available_in_reference": true
    },
    "contractualCustomer": {
      "tab": "Fakturering",
      "type": "boolean",
      "description": "This determines if they will get prices outside a pricelist or not",
      "localized_name": "Avtalkund",
      "default": false,
      "explanation": "Om kunden är en avtalskund kommer de bara få köpa artiklar de har avtal på via prislistor",
      "is_available_in_reference": true,
      "display_if": "domainModel.user.hasAtLeastSubscriptionLevel(sessionUser, 'flaivyplus')"
    },
    "invoiceCountry": {
      "tab": "Fakturering",
      "include": "restricted_values/country_codes",
      "localized_name": "Fakturaadress land"
    },
    "deliveryName": {
      "tab": "Leveransadress",
      "type": "string",
      "localized_name": "Företagsnamn  (t.ex. \"Restaurang Morten\" el. \"ICA Nära\")",
      "max_length": 255,
      "searchable": true,
      "is_available_in_reference": true
    },
    "deliveryAddress": {
      "tab": "Leveransadress",
      "type": "string",
      "searchable": true,
      "localized_name": "Adress",
      "max_length": 255,
      "is_available_in_reference": true
    },
    "deliveryAddress2": {
      "tab": "Leveransadress",
      "type": "string",
      "localized_name": "Adress 2",
      "max_length": 255,
      "is_available_in_reference": true
    },
    "deliveryZipCode": {
      "tab": "Leveransadress",
      "type": "string",
      "localized_name": "Postnummer",
      "max_length": 10,
      "is_available_in_reference": true
    },
    "deliveryCity": {
      "tab": "Leveransadress",
      "type": "string",
      "searchable": true,
      "localized_name": "Stad",
      "max_length": 255,
      "is_available_in_reference": true
    },
    "deliveryPhone": {
      "tab": "Leveransadress",
      "type": "string",
      "localized_name": "Leveranstelefon",
      "max_length": 255
    },
    "deliveryGLN": {
      "tab": "Leveransadress",
      "type": "GLN",
      "max_length": 255,
      "localized_name": "GLN-nummer för leverans",
      "is_available_in_reference": true
    },
    "hasAlcoholPermit": {
      "tab": "Detaljer",
      "type": "boolean",
      "localized_name": "Har bekräftat alkoholtillstånd",
      "is_available_in_reference": true
    },
    "minOrderValue": {
      "tab": "Leveransvillkor",
      "type": "number",
      "localized_name": "Minsta ordervärde för kund",
      "is_available_in_reference": true
    },
    "isPossibleToPlaceOrderBelowOrderMinimum": {
      "tab": "Leveransvillkor",
      "type": "boolean",
      "localized_name": "Det är möjligt för kund att lägga order under kollikrav eller minsta ordervärde mot en ev.avgift.",
      "is_available_in_reference": true
    },
    "minCollisOnOrder": {
      "tab": "Leveransvillkor",
      "type": "number",
      "localized_name": "Minsta antal kollin för kund på order",
      "is_available_in_reference": true
    },
    "kegCountsAsNCollis": {
      "tab": "Leveransvillkor",
      "type": "number",
      "localized_name": "Hur många kollin varje fat räknas som på en order för kund",
      "is_available_in_reference": true
    },
    "deliveryBreakpointText": {
      "tab": "Leveransvillkor",
      "type": "text",
      "localized_name": "Brytpunktsförklaring (brytpunktstid kan endast styras på heltimme)",
      "is_available_in_reference": true
    },
    "deliveryBreakpoint": {
      "tab": "Leveransvillkor",
      "type": "integer",
      "min_length": "0",
      "max_length": "24",
      "step": 1,
      "localized_name": "Brytpunktstid för leverans (endast hela timmar stöds)",
      "is_available_in_reference": true
    },
    "deliveryHeadsup": {
      "tab": "Leveransvillkor",
      "type": "integer",
      "min_length": "0",
      "step": 1,
      "localized_name": "Leveranstid i dagar om lagd innan brytpunkt",
      "is_available_in_reference": true
    },
    "deliveryDays": {
      "tab": "Leveransvillkor",
      "type": "openingHours",
      "localized_name": "Leveransdagar",
      "is_available_in_reference": true,
      "is_available_in_reference_ui": false
    },
    "labels": {
      "tab": "Detaljer",
      "type": "labels",
      "referenceType": "label",
      "referenceDomain": "oms",
      "localized_name": "Etiketter",
      "required": false,
      "is_available_in_reference": true,
      "default": "[]"
    },
    "owningSupplierOrganizationId": {
      "tab": "Detaljer",
      "type": "userAccessString",
      "localized_name": "Leverantörs organisation",
      "readonly": true,
      "is_available_in_reference": true,
      "is_available_in_reference_ui": false
    },
    "termsOfPayment": {
      "tab": "Detaljer",
      "include": "restricted_values/terms_of_payments",
      "description": "Must have a value if not readonly else fortnox bails",
      "localized_name": "Betalningsvillkor",
      "required": false,
      "max_length": 2,
      "fortnox_equivalent": "TermsOfPayment"
    },
    "exciseNumber": {
      "tab": "Detaljer",
      "type": "taxNumber",
      "localized_name": "Punktskattenummer (13 tecken)",
      "is_available_in_reference": true
    },
    "taxWarehouseNumber": {
      "tab": "Detaljer",
      "type": "taxNumber",
      "localized_name": "Skatteupplagsnummer (13 tecken)",
      "is_available_in_reference": true
    }
  },
  "actions": {
    "writeCustomer": {
      "name": "writeCustomer",
      "requiredRole": ["super", "supplier"],
      "localized_name": "Skapa kund",
      "submitButtonText": "Spara",
      "canCreate": true,
      "availableForCustomer": true,
      "parameters": {
        "id": {
          "linked_field": "id",
          "required": true
        },
        "includeParameters": [
          "name",
          "orderFullfillmentCenter",
          "organisationNumber",
          "customerNumber",
          "customerType",
          "chain",
          "phone",
          "email",
          "emailInvoice",
          "GLN",
          "termsOfPayment",
          "yourReference",
          "requiresGroupInvoice",
          "contractualCustomer",
          "invoiceAddress",
          "invoiceAddress2",
          "invoiceZipCode",
          "invoiceCity",
          "invoiceCountry",
          "deliveryName",
          "deliveryAddress",
          "deliveryAddress2",
          "deliveryZipCode",
          "deliveryCity",
          "deliveryCountry",
          "deliveryDays",
          "deliveryBreakpoint",
          "deliveryHeadsup",
          "minOrderValue",
          "minCollisOnOrder",
          "kegCountsAsNCollis",
          "exciseNumber",
          "taxWarehouseNumber",
          "isPossibleToPlaceOrderBelowOrderMinimum"
        ],
        "labels": {
          "linked_field": "labels",
          "use_if": "sessionUser.organization.usesSupplierCustomer"
        }
      }
    },
    "importCustomer": {
      "name": "importCustomer",
      "requiredRole": ["super", "supplier"],
      "localized_name": "Importera kunder",
      "submitButtonText": "Importera",
      "canCreate": true,
      "availableForCustomer": true,
      "parameters": {
        "includeParameters": ["*"],
        "excludeParameters": [
          "id",
          "active",
          "approvedCustomer",
          "blocked",
          "blockedReason",
          "labels"
        ],
        "name": {
          "linked_field": "name",
          "required": true,
          "required_in_ui": false
        },
        "customerNumber": {
          "linked_field": "customerNumber",
          "required": true
        },
        "labels": {
          "linked_field": "labels",
          "use_if": "sessionUser.organization.usesSupplierCustomer"
        },
        "active": {
          "linked_field": "active",
          "use_if": "sessionUser.impersonation"
        },
        "approvedCustomer": {
          "linked_field": "approvedCustomer",
          "use_if": "sessionUser.impersonation"
        },
        "blocked": {
          "linked_field": "blocked",
          "use_if": "sessionUser.impersonation"
        },
        "blockedReason": {
          "linked_field": "blockedReason",
          "use_if": "sessionUser.impersonation"
        }
      }
    },
    "writeContact": {
      "name": "writeContact",
      "requiredRole": ["super", "supplier"],
      "localized_name": "Lägg till / ändra",
      "parameters": {
        "id": {
          "linked_field": "id",
          "localized_name": "id",
          "required": true
        },
        "childId": {
          "type": "string",
          "tab": "Detaljer",
          "localized_name": "kontaktid"
        },
        "name": {
          "tab": "Detaljer",
          "type": "string",
          "localized_name": "Kundreferens",
          "required": true,
          "max_length": 50
        },
        "email": {
          "tab": "Detaljer",
          "type": "email",
          "localized_name": "E-post",
          "max_length": 255
        },
        "phone": {
          "tab": "Detaljer",
          "type": "string",
          "localized_name": "Telefon",
          "max_length": 255
        },
        "owner": {
          "tab": "Detaljer",
          "type": "string",
          "localized_name": "Ägare",
          "max_length": 255,

          "display_if": "false"
        }
      }
    },

    "deactivate": {
      "name": "deactivate",
      "requiredRole": ["super", "supplier"],
      "availableIf": "entity.active",
      "color": "danger",
      "localized_name": "Inaktivera",
      "conditional": "Är du säker?",
      "parameters": {
        "id": {
          "linked_field": "id"
        }
      }
    },
    "activate": {
      "name": "activate",
      "requiredRole": ["super", "supplier"],
      "availableIf": "entity.active === false",
      "color": "primary",
      "localized_name": "Aktivera",
      "parameters": {
        "id": {
          "linked_field": "id"
        }
      }
    },
    "removeContact": {
      "name": "removeContact",
      "requiredRole": ["super", "supplier"],
      "localized_name": "Ta bort kontakt",
      "availableForCustomer": true,
      "snowflakeAccessControlPattern": true,
      "color": "danger",
      "parameters": {
        "id": {
          "linked_field": "id",
          "localized_name": "id",
          "required": true
        },
        "childId": {
          "type": "string",
          "tab": "Detaljer",
          "localized_name": "kontaktid"
        },
        "name": {
          "tab": "Detaljer",
          "type": "string",
          "localized_name": "Kundreferens",
          "required": true,
          "readonly": true,
          "max_length": 50,
          "ui_only": true
        }
      }
    },
    "approveSupplierCustomer": {
      "name": "approveSupplierCustomer",
      "localized_name": "Godkänn kund",
      "requiredRole": ["super", "supplier"],
      "availableIf": "entity.approvedCustomer === false",
      "parameters": {
        "id": {
          "linked_field": "id"
        },
        "hasAlcoholPermit": {
          "tab": "Detaljer",
          "type": "boolean",
          "localized_name": "Har alkoholtillstånd"
        },
        "addressOk": {
          "tab": "Detaljer",
          "type": "boolean",
          "localized_name": "Kontrollerat addresser",
          "required": true
        },
        "okCreditScore": {
          "tab": "Detaljer",
          "type": "boolean",
          "localized_name": "Har kreditvärdighet?",
          "required": true
        }
      }
    },
    "blockSupplierCustomer": {
      "name": "blockSupplierCustomer",
      "localized_name": "Blocka kund från köp",
      "requiredRole": ["super", "supplier"],
      "color": "danger",
      "availableIf": "entity.blocked === false",
      "parameters": {
        "id": {
          "linked_field": "id"
        },
        "blockedReason": {
          "linked_field": "blockedReason"
        }
      }
    },
    "unblockSupplierCustomer": {
      "name": "unblockSupplierCustomer",
      "localized_name": "Tillåt kund att köpa",
      "requiredRole": ["super", "supplier"],
      "availableIf": "entity.blocked",
      "parameters": {
        "id": {
          "linked_field": "id"
        }
      }
    },
    "changeOrderFullfillmentCenter": {
      "name": "changeOrderFullfillmentCenter",
      "requiredRole": ["super"],
      "localized_name": "Ändra lagerställe",
      "description": "Ändra lagerställe",
      "parameters": {
        "includeParameters": ["id"],
        "orderFullfillmentCenter": {
          "linked_field": "orderFullfillmentCenter"
        }
      }
    }
  },
  "events": {
    "SUPPLIER_CUSTOMER_UPDATED": {
      "localized_name": "Kund uppdaterad",
      "should_inform_service": true,
      "should_inform_user": true
    },
    "SUPPLIER_CUSTOMER_CREATED": {
      "localized_name": "Kund skapad",
      "should_inform_service": true,
      "should_inform_user": true
    },
    "SUPPLIER_CUSTOMER_APPROVED": {
      "localized_name": "Kund godkänd",
      "should_inform_service": true,
      "should_inform_user": true
    },
    "SUPPLIER_CUSTOMER_ACTIVATED": {
      "localized_name": "Kund aktiverad",
      "should_inform_service": true,
      "should_inform_user": true
    },
    "SUPPLIER_CUSTOMER_DEACTIVATED": {
      "localized_name": "Kund inaktiverad",
      "should_inform_service": true,
      "should_inform_user": true
    },
    "SUPPLIER_CUSTOMER_BLOCKED": {
      "localized_name": "Kund blockerad från köp",
      "should_inform_service": true,
      "should_inform_user": true
    },
    "SUPPLIER_CUSTOMER_UNBLOCKED": {
      "localized_name": "Kund har fått tillbaka rätten att beställa",
      "should_inform_service": true,
      "should_inform_user": true
    },
    "SUPPLIER_CUSTOMER_CONTACTS_UPDATED": {
      "localized_name": "Kundkontakter uppdaterad",
      "should_inform_service": true,
      "should_inform_user": true
    },
    "SUPPLIER_CUSTOMER_OFC_CHANGED": {
      "localized_name": "Kundens leveranslager ändrat",
      "should_inform_service": true,
      "should_inform_user": true
    }
  }
}
